<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    
    <title>天空</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    

    

    

    

    

    

    

    
<link rel="stylesheet" href="/dist/build.css?v=1623049492098.css">


    <script>
        window.isPost = false
        window.aomori = {
            
            
            
        }
        window.aomori_logo_typed_animated = false
        window.aomori_search_algolia = false

    </script>

<meta name="generator" content="Hexo 5.4.0"></head>

<body>

    <div class="container">
    <header class="header">
        <div class="header-type">
            
            <div class="header-type-inner">
                
                    <a class="header-type-title" href="/">天空</a>
                
    
                
            </div>
        </div>
        <div class="header-menu">
            <div class="header-menu-inner">
                
                <a href="/">首页</a>
                
                <a href="/archives">存档</a>
                
            </div>
            <div class="header-menu-social">
                
            </div>
        </div>

        <div class="header-menu-mobile">
            <div class="header-menu-mobile-inner" id="mobile-menu-open">
                <i class="icon icon-menu"></i>
            </div>
        </div>
    </header>

    <div class="header-menu-mobile-menu">
        <div class="header-menu-mobile-menu-bg"></div>
        <div class="header-menu-mobile-menu-wrap">
            <div class="header-menu-mobile-menu-inner">
                <div class="header-menu-mobile-menu-close" id="mobile-menu-close">
                    <i class="icon icon-cross"></i>
                </div>
                <div class="header-menu-mobile-menu-list">
                    
                    <a href="/">首页</a>
                    
                    <a href="/archives">存档</a>
                    
                </div>
            </div>
        </div>
    </div>

</div>

    <div class="container">
        <div class="main">
            <section class="inner">
                <section class="inner-main">
                    <div class="index">
  
    
      <article
id="post-CentOS/CentOS7 安装 HAProxy"
class="article article-type-post"
>



<div class="article-inner">
    

    <div class="article-body">
    <header class="article-title">
        <a href="/CentOS/CentOS7%20%E5%AE%89%E8%A3%85%20HAProxy/">CentOS7 安装 HAProxy</a>
    </header>
    <div class="article-entry post-inner-html">
        
        <p>[TOC]</p>
<h1 id="CentOS7-安装-HAProxy"><a href="#CentOS7-安装-HAProxy" class="headerlink" title="CentOS7 安装 HAProxy"></a>CentOS7 安装 HAProxy</h1><ul>
<li>CentOS 7</li>
<li>HAproxy-1.3.20</li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://haproxy.1wt.eu/download/1.3/src/haproxy-1.3.20.tar.gz</span><br><span class="line">tar -zxvf haproxy-1.3.20.tar.gz</span><br></pre></td></tr></table></figure>

<p>将haproxy安装到 /usr/local/haproxy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd haproxy-1.3.20</span><br><span class="line">make TARGET=linux26 PREFIX=/usr/local/haproxy</span><br></pre></td></tr></table></figure>

<p>开始安装安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># make install PREFIX=/usr/local/haproxy</span><br></pre></td></tr></table></figure>

<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>安装完毕后，进入安装目录配置文件，</p>
<p>默认情况下目录里是没有 <code>.cfg</code> 配置文件的，可以从安装文件目录中 <code>examples 下的 haproxy.cfg</code> 拷贝到 /usr/local/haproxy 下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># cd /usr/local/haproxy</span><br><span class="line"># vi haproxy.cfg</span><br></pre></td></tr></table></figure>

<p>根据实际需求，更改配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">global                      #全局设置</span><br><span class="line">   log 127.0.0.1 local0     #日志输出配置，所有日志都记录在本机，通过local0输出</span><br><span class="line">   #log loghost local0 info</span><br><span class="line">   maxconn 4096             #最大连接数</span><br><span class="line">   chroot /usr/local/haproxy</span><br><span class="line">   uid 99                   #所属运行的用户uid</span><br><span class="line">   gid 99                   #所属运行的用户组</span><br><span class="line">   daemon                   #以后台形式运行haproxy</span><br><span class="line">   nbproc 2                 #启动2个haproxy实例</span><br><span class="line">   pidfile /usr/local/haproxy/haproxy.pid  #将所有进程写入pid文件</span><br><span class="line">   #debug</span><br><span class="line">   #quiet</span><br><span class="line"></span><br><span class="line">defaults                    #默认设置</span><br><span class="line">   #log global</span><br><span class="line">   log 127.0.0.1 local3     #日志文件的输出定向</span><br><span class="line">   mode http                #所处理的类别,默认采用http模式，可配置成tcp作4层消息转发</span><br><span class="line">   option httplog           #日志类别,采用httplog</span><br><span class="line">   option dontlognull </span><br><span class="line">   option forwardfor        #如果后端服务器需要获得客户端真实ip需要配置的参数，可以从Http Header中获得客户端ip</span><br><span class="line">   option httpclose         #每次请求完毕后主动关闭http通道,haproxy不支持keep-alive,只能模拟这种模式的实现</span><br><span class="line">   retries 3                #3次连接失败就认为服务器不可用，主要通过后面的check检查</span><br><span class="line">   option redispatch        #当serverid对应的服务器挂掉后，强制定向到其他健康服务器</span><br><span class="line">   maxconn 2000             #最大连接数</span><br><span class="line">   stats uri /haproxy-admin #haproxy 监控页面的访问地址</span><br><span class="line">   contimeout 5000          #连接超时时间</span><br><span class="line">   clitimeout 50000         #客户端连接超时时间</span><br><span class="line">   srvtimeout 50000         #服务器端连接超时时间</span><br><span class="line">stats auth admin:admin      #设置监控页面的用户和密码：admin</span><br><span class="line">stats hide-version          #隐藏统计页面的HAproxy版本信息</span><br><span class="line"></span><br><span class="line">frontend http-in            #前台</span><br><span class="line">   bind *:80</span><br><span class="line">   mode http</span><br><span class="line">   option httplog</span><br><span class="line">   log global</span><br><span class="line">   default_backend htmpool  #静态服务器池</span><br><span class="line"></span><br><span class="line">backend htmpool             #后台</span><br><span class="line">   balance leastconn        #负载均衡算法</span><br><span class="line">   option httpchk HEAD /index.htm HTTP/1.0       #健康检查</span><br><span class="line">   server web1 10.16.0.9:8085 cookie 1 weight 5 check inter 2000 rise 2 fall 3</span><br><span class="line">   server web2 10.16.0.10:8085 cookie 2 weight 3 check inter 2000 rise 2 fall 3</span><br></pre></td></tr></table></figure>
<p>负载均衡配置说明</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#cookie        1	   表示serverid为1，</span><br><span class="line">#check inter	1500 	是检测心跳频率</span><br><span class="line">#rise          2	   是2次正确认为服务器可用，</span><br><span class="line">#fall          3	   是3次失败认为服务器不可用，</span><br><span class="line">#weight        5	   代表权重</span><br></pre></td></tr></table></figure>


<h2 id="增加日志支持"><a href="#增加日志支持" class="headerlink" title="增加日志支持"></a>增加日志支持</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># vim /etc/syslog.conf</span><br></pre></td></tr></table></figure>
<p>在最下边增加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">local3.*         /var/log/haproxy.log</span><br><span class="line">local0.*         /var/log/haproxy.log</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#vim /etc/sysconfig/syslog</span><br></pre></td></tr></table></figure>
<p>修改： </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYSLOGD_OPTIONS=&quot;-r -m 0&quot;</span><br></pre></td></tr></table></figure>
<p>重启日志服务 <code>service syslog restart</code></p>
<h2 id="设置开机启动"><a href="#设置开机启动" class="headerlink" title="设置开机启动"></a>设置开机启动</h2><p>为了方便系统在开机时加载，还可以创建启动脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># vim /etc/rc.d/init.d/haproxy</span><br></pre></td></tr></table></figure>
<p>【内容如下】</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">#! /bin/sh</span><br><span class="line">set -e</span><br><span class="line"></span><br><span class="line">PATH=/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/haproxy/sbin</span><br><span class="line">PROGDIR=/usr/local/haproxy</span><br><span class="line">PROGNAME=haproxy</span><br><span class="line">DAEMON=$PROGDIR/sbin/$PROGNAME</span><br><span class="line">CONFIG=$PROGDIR/$PROGNAME.conf</span><br><span class="line">PIDFILE=$PROGDIR/$PROGNAME.pid</span><br><span class="line">DESC=&quot;HAProxy daemon&quot;</span><br><span class="line">SCRIPTNAME=/etc/init.d/$PROGNAME</span><br><span class="line"></span><br><span class="line"># Gracefully exit if the package has been removed.</span><br><span class="line">test -x $DAEMON || exit 0</span><br><span class="line"></span><br><span class="line">start()</span><br><span class="line">&#123;</span><br><span class="line">       echo -n &quot;Starting $DESC: $PROGNAME&quot;</span><br><span class="line">       $DAEMON -f $CONFIG</span><br><span class="line">       echo &quot;.&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stop()</span><br><span class="line">&#123;</span><br><span class="line">       echo -n &quot;Stopping $DESC: $PROGNAME&quot;</span><br><span class="line">       haproxy_pid=cat $PIDFILE</span><br><span class="line">       kill $haproxy_pid</span><br><span class="line">       echo &quot;.&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">restart()</span><br><span class="line">&#123;</span><br><span class="line">       echo -n &quot;Restarting $DESC: $PROGNAME&quot;</span><br><span class="line">       $DAEMON -f $CONFIG -p $PIDFILE -sf $(cat $PIDFILE)</span><br><span class="line">       echo &quot;.&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line"> start)</span><br><span class="line">       start</span><br><span class="line">       ;;</span><br><span class="line"> stop)</span><br><span class="line">       stop</span><br><span class="line">       ;;</span><br><span class="line"> restart)</span><br><span class="line">       restart</span><br><span class="line">       ;;</span><br><span class="line"> *)</span><br><span class="line">       echo &quot;Usage: $SCRIPTNAME &#123;start|stop|restart&#125;&quot; &gt;&amp;2</span><br><span class="line">       exit 1</span><br><span class="line">       ;;</span><br><span class="line">esac</span><br><span class="line">exit 0</span><br></pre></td></tr></table></figure>
<p>保存后赐予可执行权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># chmod +x /etc/rc.d/init.d/haproxy</span><br></pre></td></tr></table></figure>
<p>就可以使用 service haproxy start|stop|restart 来控***务的启动停止跟重启。</p>
<p>并通过以下命令加载到开机服务启动列表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># chkconfig --add haproxy</span><br></pre></td></tr></table></figure>

<h2 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h2><p>启动服务：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># /usr/local/haproxy/sbin/haproxy -f /usr/local/haproxy/haproxy.cfg</span><br></pre></td></tr></table></figure>
<p>重启服务 (没有换行)：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># /usr/local/haproxy/sbin/haproxy -f /usr/local/haproxy/haproxy.cfg -st `cat /usr/local/haproxy/logs/haproxy.pid`</span><br></pre></td></tr></table></figure>
<p>停止服务：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># killall haproxy</span><br></pre></td></tr></table></figure>

<h2 id="访问"><a href="#访问" class="headerlink" title="访问"></a>访问</h2><p>在浏览器中输入 haproxy 监控地址: <code>http://10.16.0.246:1080/haproxy-admin</code></p>
<p>在浏览器输入 haproxy 设置的 <code>对外访问地址</code> 访问系统</p>

        
    </div>
    </div>

    <div class="article-badge">
        
        
    </div>

</div>

<footer class="article-footer">
    <div class="article-more-info">
    <div class="article-date">
  <time datetime="2021-04-25T04:55:47.329Z" itemprop="datePublished">2021-04-25</time>
</div>
    
        <div class="article-category">
        <a class="article-category-link" href="/categories/CentOS/">CentOS</a>
        </div>
    
    
        <div class="article-tag">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CentOS/" rel="tag">CentOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HAProxy/" rel="tag">HAProxy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" rel="tag">环境搭建</a></li></ul>
        </div>
    
    </div>
</footer>

</article>

    
  
    
      <article
id="post-CentOS/CentOS7 安装 Docker"
class="article article-type-post"
>



<div class="article-inner">
    

    <div class="article-body">
    <header class="article-title">
        <a href="/CentOS/CentOS7%20%E5%AE%89%E8%A3%85%20Docker/">CentOS7 安装 Docker</a>
    </header>
    <div class="article-entry post-inner-html">
        
        <h2 id="CentOS7-安装-Docker"><a href="#CentOS7-安装-Docker" class="headerlink" title="CentOS7 安装 Docker"></a>CentOS7 安装 Docker</h2><p>Docker 支持以下的 CentOS 版本：</p>
<ul>
<li>CentOS 7 (64-bit)</li>
<li>CentOS 6.5 (64-bit) 或更高的版本</li>
</ul>
<h3 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h3><p>目前，CentOS 仅发行版本中的内核支持 Docker。</p>
<ul>
<li>Docker 运行在 CentOS 7 上，要求系统为64位、系统内核版本为 3.10 以上。</li>
<li>Docker 运行在 CentOS-6.5 或更高的版本的 CentOS 上，要求系统为64位、系统内核版本为 2.6.32-431 或者更高版本。</li>
</ul>
<h3 id="使用-yum-安装-（CentOS-7）"><a href="#使用-yum-安装-（CentOS-7）" class="headerlink" title="使用 yum 安装 （CentOS 7）"></a>使用 yum 安装 （CentOS 7）</h3><blockquote>
<p>Docker 要求 CentOS 系统的内核版本高于 3.10</p>
</blockquote>
<h4 id="查看当前的内核版本"><a href="#查看当前的内核版本" class="headerlink" title="查看当前的内核版本"></a>查看当前的内核版本</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -r </span><br></pre></td></tr></table></figure>

<h4 id="安装-Docker"><a href="#安装-Docker" class="headerlink" title="安装 Docker"></a>安装 Docker</h4><p>从 2017 年 3 月开始 docker 在原来的基础上分为两个分支版本: Docker CE 和 Docker EE。</p>
<p>Docker CE 即社区免费版，Docker EE 即企业版，强调安全，但需付费使用。</p>
<blockquote>
<p>本文介绍 Docker CE 的安装使用</p>
</blockquote>
<h4 id="移除旧的版本"><a href="#移除旧的版本" class="headerlink" title="移除旧的版本"></a>移除旧的版本</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ yum remove docker \</span><br><span class="line">      docker-client \</span><br><span class="line">      docker-client-latest \</span><br><span class="line">      docker-common \</span><br><span class="line">      docker-latest \</span><br><span class="line">      docker-latest-logrotate \</span><br><span class="line">      docker-logrotate \</span><br><span class="line">      docker-selinux \</span><br><span class="line">      docker-engine-selinux \</span><br><span class="line">      docker-engine</span><br></pre></td></tr></table></figure>

<h4 id="安装一些必要的系统工具"><a href="#安装一些必要的系统工具" class="headerlink" title="安装一些必要的系统工具"></a>安装一些必要的系统工具</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure>

<h4 id="添加软件源信息"><a href="#添加软件源信息" class="headerlink" title="添加软件源信息"></a>添加软件源信息</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>

<p><img src="images/yum-config-manager.png" alt="img"></p>
<h4 id="更新-yum-缓存"><a href="#更新-yum-缓存" class="headerlink" title="更新 yum 缓存"></a>更新 yum 缓存</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum makecache fast</span><br></pre></td></tr></table></figure>

<p><img src="images/yum-makecache-fast.png" alt="img"></p>
<h3 id="安装-Docker-ce"><a href="#安装-Docker-ce" class="headerlink" title="安装 Docker-ce"></a>安装 Docker-ce</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install docker-ce</span><br></pre></td></tr></table></figure>

<h3 id="启动-Docker-后台服务"><a href="#启动-Docker-后台服务" class="headerlink" title="启动 Docker 后台服务"></a>启动 Docker 后台服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure>

<h3 id="测试运行-hello-world"><a href="#测试运行-hello-world" class="headerlink" title="测试运行 hello-world"></a>测试运行 hello-world</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure>

<p><img src="images/docker-run-hello-world.png" alt="img"></p>
<p>由于本地没有 hello-world 这个镜像，所以会下载一个hello-world的镜像，并在容器内运行</p>

        
    </div>
    </div>

    <div class="article-badge">
        
        
    </div>

</div>

<footer class="article-footer">
    <div class="article-more-info">
    <div class="article-date">
  <time datetime="2021-04-25T04:54:36.007Z" itemprop="datePublished">2021-04-25</time>
</div>
    
        <div class="article-category">
        <a class="article-category-link" href="/categories/CentOS/">CentOS</a>
        </div>
    
    
        <div class="article-tag">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CentOS/" rel="tag">CentOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" rel="tag">环境搭建</a></li></ul>
        </div>
    
    </div>
</footer>

</article>

    
  
    
      <article
id="post-计算机网络/C10K 问题"
class="article article-type-post"
>



<div class="article-inner">
    

    <div class="article-body">
    <header class="article-title">
        <a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/C10K%20%E9%97%AE%E9%A2%98/">C10K 问题</a>
    </header>
    <div class="article-entry post-inner-html">
        
        <h1 id="C10K-问题"><a href="#C10K-问题" class="headerlink" title="C10K 问题"></a>C10K 问题</h1><h2 id="问题由来"><a href="#问题由来" class="headerlink" title="问题由来"></a>问题由来</h2><ul>
<li>如何突破单机性能是高性能网络编程必须要面对的问题，进而这些局限和问题就统称为C10K问题</li>
<li>最初的服务器是 <code>基于进程/线程模型</code></li>
<li>新到来一个TCP连接，就需要分配一个进程</li>
<li>假如有C10K，就需要创建1W个进程，可想而知单机是无法承受的</li>
</ul>
<h2 id="问题的本质"><a href="#问题的本质" class="headerlink" title="问题的本质"></a>问题的本质</h2><ul>
<li>本质上是操作系统的问题<ul>
<li>对于Web 1.0/2.0时代的操作系统，传统的同步阻塞I/O模型处理方式都是 requests per second</li>
<li>当创建的进程或线程多了</li>
<li>数据拷贝频繁（缓存I/O）、内核将数据拷贝到用户进程空间、阻塞，进程/线程上下文切换消耗大</li>
<li>导致操作系统崩溃</li>
</ul>
</li>
<li>解决问题的关键<ul>
<li>尽可能减少这些CPU资源消耗</li>
</ul>
</li>
</ul>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>从网络编程技术的角度来说，主要思路：</p>
<ol>
<li>每个连接分配一个独立的线程/进程</li>
<li>同一个线程/进程同时处理多个连接</li>
</ol>
<h3 id="每个进程-线程处理一个连接"><a href="#每个进程-线程处理一个连接" class="headerlink" title="每个进程/线程处理一个连接"></a>每个进程/线程处理一个连接</h3><ul>
<li>申请进程/线程是需要系统资源的</li>
<li>且系统需要管理这些进程/线程</li>
<li>会使资源占用过多</li>
<li>可扩展性差</li>
</ul>
<h3 id="每个进程-线程同时处理-多个连接-I-O多路复用"><a href="#每个进程-线程同时处理-多个连接-I-O多路复用" class="headerlink" title="每个进程/线程同时处理 多个连接(I/O多路复用)"></a>每个进程/线程同时处理 多个连接(I/O多路复用)</h3><h4 id="select-方式"><a href="#select-方式" class="headerlink" title="select 方式"></a>select 方式</h4><ul>
<li>使用 fd_set 结构体告诉内核同时监控那些文件句柄</li>
<li>使用逐个排查方式去检查是否有文件句柄就绪或者超时</li>
<li>缺点<ul>
<li>文件句柄数量是有上线的</li>
<li>逐个检查吞吐量低</li>
<li>每次调用都要重复初始化 fd_set</li>
</ul>
</li>
</ul>
<h4 id="poll-方式"><a href="#poll-方式" class="headerlink" title="poll 方式"></a>poll 方式</h4><ul>
<li>解决了 select 方式的2个缺点</li>
<li>链表方式存储</li>
<li>不同字段标注关注事件和发生事件</li>
<li>缺点<ul>
<li>逐个去检查文件句柄是否就绪的问题仍然没有解决</li>
</ul>
</li>
</ul>
<h4 id="epoll-方式（Linux）"><a href="#epoll-方式（Linux）" class="headerlink" title="epoll 方式（Linux）"></a>epoll 方式（Linux）</h4><ul>
<li><p>使用”事件”的就绪通知方式，</p>
<ul>
<li>通过 epoll_ctl 注册文件描述符 fd，</li>
<li>一旦该 fd 就绪，内核就会采用类似 callback 的回调机制来激活该 fd, </li>
<li>epoll_wait 便可以收到通知, 并通知应用程序</li>
</ul>
</li>
<li><p>使用一个文件描述符管理多个描述符,将用户进程的文件描述符的事件存放到内核的一个事件表中, 这样数据只需要从内核缓存空间拷贝一次到用户进程地址空间</p>
</li>
<li><p>通过内核与用户空间共享内存方式来实现事件就绪消息传递的，其效率非常高</p>
</li>
<li><p>不去轮询监听所有文件句柄是否已经就绪</p>
</li>
<li><p>只对发生变化的文件句柄感兴趣</p>
</li>
</ul>
<h4 id="异步-I-O-以及-Windows"><a href="#异步-I-O-以及-Windows" class="headerlink" title="异步 I/O 以及 Windows"></a>异步 I/O 以及 Windows</h4><ul>
<li>该方式在windows上支持很好</li>
</ul>

        
    </div>
    </div>

    <div class="article-badge">
        
        
    </div>

</div>

<footer class="article-footer">
    <div class="article-more-info">
    <div class="article-date">
  <time datetime="2021-04-25T04:53:16.000Z" itemprop="datePublished">2021-04-25</time>
</div>
    
        <div class="article-category">
        <a class="article-category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a>
        </div>
    
    
        <div class="article-tag">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" rel="tag">异常处理</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag">计算机网络</a></li></ul>
        </div>
    
    </div>
</footer>

</article>

    
  
    
      <article
id="post-VS2015/VS2015 使用批处理方法打包 exe"
class="article article-type-post"
>



<div class="article-inner">
    

    <div class="article-body">
    <header class="article-title">
        <a href="/VS2015/VS2015%20%E4%BD%BF%E7%94%A8%E6%89%B9%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%E6%89%93%E5%8C%85%20exe/">VS2015 使用批处理方法打包 exe</a>
    </header>
    <div class="article-entry post-inner-html">
        
        <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /d %~dp0</span><br><span class="line"></span><br><span class="line">setlocal enabledelayedexpansion</span><br><span class="line"><span class="keyword">for</span> /f <span class="string">&quot;delims=&quot;</span> %%i <span class="keyword">in</span> (<span class="string">&#x27;type &quot;config.ini&quot;^| find /i &quot;=&quot;&#x27;</span>) <span class="keyword">do</span> <span class="built_in">set</span> %%i</span><br><span class="line"></span><br><span class="line">rem Release / Debug</span><br><span class="line"><span class="built_in">set</span> BUILD_CONFIG=Release</span><br><span class="line">rem build / rebuild / clean</span><br><span class="line"><span class="built_in">set</span> BUILD_TYPE=clean;build</span><br><span class="line">rem Any CPU / x64 / Win32</span><br><span class="line"><span class="built_in">set</span> BUILD_PLATFORM=<span class="string">&quot;Win32&quot;</span></span><br><span class="line"></span><br><span class="line">@<span class="built_in">echo</span> -------------------------</span><br><span class="line">@<span class="built_in">echo</span> 编译开始</span><br><span class="line">@<span class="built_in">echo</span> -------------------------</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /d %CPP_PATH%</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> not exist build md build</span><br><span class="line"></span><br><span class="line">@<span class="built_in">echo</span> </span><br><span class="line">@<span class="built_in">echo</span> 开始更新代码</span><br><span class="line">git pull origin master</span><br><span class="line"></span><br><span class="line">@<span class="built_in">echo</span> </span><br><span class="line">@<span class="built_in">echo</span> 生成 vs2015 工程到 build 目录</span><br><span class="line"><span class="built_in">cd</span> /d %OUTPUT_PATH%</span><br><span class="line">cmake -T v140_xp ..</span><br><span class="line"></span><br><span class="line">@<span class="built_in">echo</span> </span><br><span class="line">@<span class="built_in">echo</span> 编译 可执行文件</span><br><span class="line"><span class="string">&quot;%MSBUILD_PATH%&quot;</span> %SOLUTION_FILE% /t:%BUILD_TYPE% /p:Configuration=%BUILD_CONFIG%;Platform=%BUILD_PLATFORM%;OutDir=%OUTPUT_PATH%\%BUILD_CONFIG% /m</span><br><span class="line"></span><br><span class="line">@<span class="built_in">echo</span> 打包 安装文件</span><br><span class="line"><span class="built_in">cd</span> /d %NSIS_PATH%</span><br><span class="line">makensisw <span class="string">&quot;%NSIS_FILE%&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /d %~dp0</span><br><span class="line"><span class="keyword">if</span> not exist output-win md output-win</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /d %~dp0/output-win</span><br><span class="line"><span class="keyword">if</span> not exist exe md exe</span><br><span class="line"><span class="keyword">if</span> not exist pdb md pdb</span><br><span class="line"><span class="keyword">if</span> not exist app md app</span><br><span class="line"></span><br><span class="line">copy %OUTPUT_PATH%\Release\*.exe exe\</span><br><span class="line">copy %OUTPUT_PATH%\Release\*.dll exe\</span><br><span class="line">copy %OUTPUT_PATH%\Release\*.pdb pdb\</span><br><span class="line">copy %OUTPUT_PATH%\..\install-script\*-Setup*.exe</span><br><span class="line"></span><br><span class="line">@<span class="built_in">echo</span> -------------------------</span><br><span class="line">@<span class="built_in">echo</span> 编译结束</span><br><span class="line">@<span class="built_in">echo</span> -------------------------</span><br><span class="line"></span><br><span class="line">pause</span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure>


        
    </div>
    </div>

    <div class="article-badge">
        
        
    </div>

</div>

<footer class="article-footer">
    <div class="article-more-info">
    <div class="article-date">
  <time datetime="2021-04-25T04:52:10.105Z" itemprop="datePublished">2021-04-25</time>
</div>
    
        <div class="article-category">
        <a class="article-category-link" href="/categories/VS2015/">VS2015</a>
        </div>
    
    
        <div class="article-tag">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/VS2015/" rel="tag">VS2015</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%89%B9%E5%A4%84%E7%90%86/" rel="tag">批处理</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%9F%E6%9F%A5/" rel="tag">速查</a></li></ul>
        </div>
    
    </div>
</footer>

</article>

    
  
    
      <article
id="post-Oracle/Oracle 常用 SQL"
class="article article-type-post"
>



<div class="article-inner">
    

    <div class="article-body">
    <header class="article-title">
        <a href="/Oracle/Oracle%20%E5%B8%B8%E7%94%A8%20SQL/">Oracle 常用 SQL</a>
    </header>
    <div class="article-entry post-inner-html">
        
        <h4 id="使用正则表达式查询"><a href="#使用正则表达式查询" class="headerlink" title="使用正则表达式查询"></a>使用正则表达式查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TABLEA(</span><br><span class="line">ID NUMBER(<span class="number">2</span>) <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">NUM NUMBER(<span class="number">10</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">CREATE</span> SEQUENCE TABLE_SEQ;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLEA <span class="keyword">VALUES</span> (TABLE_SEQ.NEXTVAL,<span class="number">111</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLEA <span class="keyword">VALUES</span> (TABLE_SEQ.NEXTVAL,<span class="number">222</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLEA <span class="keyword">VALUES</span> (TABLE_SEQ.NEXTVAL,<span class="number">333</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLEA <span class="keyword">VALUES</span> (TABLE_SEQ.NEXTVAL,<span class="number">444</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLEA <span class="keyword">VALUES</span> (TABLE_SEQ.NEXTVAL,<span class="number">555</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">with</span> myview <span class="keyword">as</span>(<span class="keyword">select</span> <span class="string">&#x27;1,2,2,4,3&#x27;</span> vchar <span class="keyword">from</span> dual)</span><br><span class="line"><span class="keyword">select</span> c.<span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> myview a , (<span class="keyword">select</span> rownum <span class="keyword">as</span> rn <span class="keyword">from</span> dual <span class="keyword">connect</span> <span class="keyword">by</span> rownum <span class="operator">&lt;=</span><span class="number">100</span>) b ,tablea c</span><br><span class="line"><span class="keyword">where</span> regexp_substr(VCHAR,<span class="string">&#x27;[^,]+&#x27;</span>,<span class="number">1</span>,rn) <span class="operator">=</span> c.id</span><br><span class="line"><span class="keyword">and</span> regexp_substr(VCHAR,<span class="string">&#x27;[^,]+&#x27;</span>,<span class="number">1</span>,rn) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure>

<h3 id="权限管理-DCL-语句"><a href="#权限管理-DCL-语句" class="headerlink" title="权限管理 (DCL) 语句"></a>权限管理 (DCL) 语句</h3><h4 id="GRANT-权限"><a href="#GRANT-权限" class="headerlink" title="GRANT 权限"></a>GRANT 权限</h4><p>常用的系统权限集合：</p>
<ol>
<li>CONNECT： 基本的连接</li>
<li>RESOURCE： 程序开发</li>
<li>DBA： 数据库管理</li>
</ol>
<p>常用的数据对象权限：</p>
<ol>
<li>ALL ON 数据对象名</li>
<li>SELECT ON 数据对象名</li>
<li>UPDATE ON 数据对象名</li>
<li>DELETE ON 数据对象名</li>
<li>INSERT ON 数据对象名</li>
<li>ALTER  ON 数据对象名</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">CONNECT</span>, RESOURCE <span class="keyword">TO</span> 用户名;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span> <span class="keyword">ON</span> 表名 <span class="keyword">TO</span> 用户名;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">INSERT</span>, <span class="keyword">DELETE</span> <span class="keyword">ON</span> 表名 <span class="keyword">TO</span> 用户名<span class="number">1</span>, 用户名<span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<h4 id="REVOKE-回收权限"><a href="#REVOKE-回收权限" class="headerlink" title="REVOKE 回收权限"></a>REVOKE 回收权限</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">CONNECT</span>, RESOURCE <span class="keyword">FROM</span> 用户名;</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">SELECT</span> <span class="keyword">ON</span> 表名 <span class="keyword">FROM</span> 用户名;</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">SELECT</span>, <span class="keyword">INSERT</span>, <span class="keyword">DELETE</span> <span class="keyword">ON</span>表名 <span class="keyword">FROM</span> 用户名<span class="number">1</span>, 用户名<span class="number">2</span>;</span><br></pre></td></tr></table></figure>


<h4 id="查看某对象的锁"><a href="#查看某对象的锁" class="headerlink" title="查看某对象的锁"></a>查看某对象的锁</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> A.OWNER,</span><br><span class="line">       A.OBJECT_NAME,</span><br><span class="line">       B.XIDUSN,</span><br><span class="line">       B.XIDSLOT,</span><br><span class="line">       B.XIDSQN,</span><br><span class="line">       B.SESSION_ID,</span><br><span class="line">       B.ORACLE_USERNAME,</span><br><span class="line">       B.OS_USER_NAME,</span><br><span class="line">       B.PROCESS,</span><br><span class="line">       B.LOCKED_MODE,</span><br><span class="line">       C.MACHINE,</span><br><span class="line">       C.STATUS,</span><br><span class="line">       C.SERVER,</span><br><span class="line">       C.SID,</span><br><span class="line">       C.SERIAL#,</span><br><span class="line">       C.PROGRAM</span><br><span class="line"><span class="keyword">FROM</span> ALL_OBJECTS A, V$LOCKED_OBJECT B, SYS.GV_$SESSION C</span><br><span class="line"><span class="keyword">WHERE</span> (A.OBJECT_ID <span class="operator">=</span> B.OBJECT_ID)</span><br><span class="line">    <span class="keyword">AND</span> (B.PROCESS <span class="operator">=</span> C.PROCESS)</span><br><span class="line">    <span class="keyword">AND</span> A.OBJECT_NAME <span class="operator">=</span> <span class="built_in">upper</span>(<span class="string">&#x27;&amp;table_name&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="中文字符按拼音排序"><a href="#中文字符按拼音排序" class="headerlink" title="中文字符按拼音排序"></a>中文字符按拼音排序</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="string">&#x27;张三&#x27;</span> NAME  <span class="keyword">FROM</span> DUAL</span><br><span class="line">        <span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line">        <span class="keyword">SELECT</span> <span class="string">&#x27;李四&#x27;</span> NAME <span class="keyword">FROM</span> DUAL</span><br><span class="line">        <span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line">        <span class="keyword">SELECT</span> <span class="string">&#x27;王五&#x27;</span> NAME <span class="keyword">FROM</span> DUAL)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> NLSSORT(NAME, <span class="string">&#x27;NLS_SORT=SCHINESE_PINYIN_M&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>第一个参数是需要排序的字段</li>
<li>第二个参数值可选下列字符串<ul>
<li>SCHINESE_RADICAL_M 按照部首（第一顺序）、笔划（第二顺序）排序</li>
<li>SCHINESE_STROKE_M 按照笔划（第一顺序）、部首（第二顺序）排序</li>
<li>SCHINESE_PINYIN_M 按照拼音排序，系统的默认排序方式为拼音排序</li>
</ul>
</li>
</ul>

        
    </div>
    </div>

    <div class="article-badge">
        
        
    </div>

</div>

<footer class="article-footer">
    <div class="article-more-info">
    <div class="article-date">
  <time datetime="2021-04-25T04:49:42.000Z" itemprop="datePublished">2021-04-25</time>
</div>
    
        <div class="article-category">
        <a class="article-category-link" href="/categories/Oracle/">Oracle</a>
        </div>
    
    
        <div class="article-tag">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Oracle/" rel="tag">Oracle</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%9F%E6%9F%A5/" rel="tag">速查</a></li></ul>
        </div>
    
    </div>
</footer>

</article>

    
  
    
      <article
id="post-MySQL/MySQL 异常处理"
class="article article-type-post"
>



<div class="article-inner">
    

    <div class="article-body">
    <header class="article-title">
        <a href="/MySQL/MySQL%20%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/">MySQL 异常处理</a>
    </header>
    <div class="article-entry post-inner-html">
        
        <p>[TOC]</p>
<h2 id="Access-denied-for-user-‘root‘-’192-168-1-100’-using-password-YES"><a href="#Access-denied-for-user-‘root‘-’192-168-1-100’-using-password-YES" class="headerlink" title="Access denied for user ‘root‘@’192.168.1.100’ (using password: YES)"></a>Access denied for user ‘root‘@’192.168.1.100’ (using password: YES)</h2><h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grant all privileges on *.* to root@&#x27;%&#x27; identified by &#x27;root&#x27;;</span><br></pre></td></tr></table></figure>

<h2 id="Packet-for-query-is-too-large"><a href="#Packet-for-query-is-too-large" class="headerlink" title="Packet for query is too large"></a>Packet for query is too large</h2><h3 id="报错信息"><a href="#报错信息" class="headerlink" title="报错信息"></a>报错信息</h3><p>Caused by: com.mysql.jdbc.PacketTooBigException: Packet for query is too large (1354 &gt; 1024). You can change this value on the server by setting the max_allowed_packet’ variable</p>
<h3 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h3><p>MySQL 根据配置文件会<code>限制 Server 接受的数据包大小</code>。有时候插入、更新或查询时数据包的大小，会受 max_allowed_packet 参数限制，导致操作失败。</p>
<p>查看 max_allowed_packet 参数：</p>
<p>在客户端执行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show VARIABLES like &#x27;%max_allowed_packet%&#x27;; </span><br></pre></td></tr></table></figure>

<p>得到结果如下：</p>
<table>
<thead>
<tr>
<th>Variable_name</th>
<th>Value</th>
</tr>
</thead>
<tbody><tr>
<td>max_allowed_packet</td>
<td>1024</td>
</tr>
</tbody></table>
<p>注意： 如果重复一直重复出现此问题，有可能是服务器内存容量不够或是黑客攻击，需要检查服务器及网络安全</p>
<h3 id="解决方法-1"><a href="#解决方法-1" class="headerlink" title="解决方法"></a>解决方法</h3><h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 使用 root 用户登录 MySQL</span><br><span class="line">mysql -uroot -p</span><br><span class="line"></span><br><span class="line"># 修改配置</span><br><span class="line">set global max_allowed_packet = 100 * 1024 * 1024;</span><br></pre></td></tr></table></figure>

<p>注意：此方法，MySQL重启后会失效</p>
<h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><p>修改 MySQL 配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim my.cnf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 [mysqId] 下面添加</span></span><br><span class="line">max_allowed_packet = 100M</span><br></pre></td></tr></table></figure>

<p>重启 MySQL</p>
<p>如果找不到 my.cnf 可以通过一下命令查找</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql --<span class="built_in">help</span> | grep my.cnf</span><br></pre></td></tr></table></figure>
        
    </div>
    </div>

    <div class="article-badge">
        
        
    </div>

</div>

<footer class="article-footer">
    <div class="article-more-info">
    <div class="article-date">
  <time datetime="2021-04-25T04:45:15.000Z" itemprop="datePublished">2021-04-25</time>
</div>
    
        <div class="article-category">
        <a class="article-category-link" href="/categories/MySQL/">MySQL</a>
        </div>
    
    
        <div class="article-tag">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" rel="tag">异常处理</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%9F%E6%9F%A5/" rel="tag">速查</a></li></ul>
        </div>
    
    </div>
</footer>

</article>

    
  
    
      <article
id="post-Linux/Linux 常用命令"
class="article article-type-post"
>



<div class="article-inner">
    

    <div class="article-body">
    <header class="article-title">
        <a href="/Linux/Linux%20%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">Linux 常用命令</a>
    </header>
    <div class="article-entry post-inner-html">
        
        <p>[TOC]</p>
<h1 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h1><h2 id="查看系统版本"><a href="#查看系统版本" class="headerlink" title="查看系统版本"></a>查看系统版本</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前操作系统版本信息</span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat /proc/version</span></span><br><span class="line">Linux version 4.18.0-147.5.1.el8_1.x86_64 (mockbuild@kbuilder.bsys.centos.org) (gcc version 8.3.1 20190507 (Red Hat 8.3.1-4) (GCC)) <span class="comment">#1 SMP Wed Feb 5 02:00:39 UTC 2020</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看当前操作系统内核信息</span></span><br><span class="line">[root@localhost ~]<span class="comment"># uname -a</span></span><br><span class="line">Linux iZ2zeb33po2qdlf0ibaldcZ 4.18.0-147.5.1.el8_1.x86_64 <span class="comment">#1 SMP Wed Feb 5 02:00:39 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看当前操作系统发行信息</span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat /etc/centos-release</span></span><br><span class="line">CentOS Linux release 8.1.1911 (Core)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看系统版本信息，需要安装 yum install redhat-lsb -y</span></span><br><span class="line">[root@localhost etc]<span class="comment"># lsb_release -a</span></span><br><span class="line">LSB Version:    :core-4.1-amd64:core-4.1-noarch</span><br><span class="line">Distributor ID: CentOS</span><br><span class="line">Description:    CentOS Linux release 8.1.1911 (Core)</span><br><span class="line">Release:        8.1.1911</span><br><span class="line">Codename:       Core</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="查看-CPU-信息"><a href="#查看-CPU-信息" class="headerlink" title="查看 CPU 信息"></a>查看 CPU 信息</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/cpuinfo</span><br></pre></td></tr></table></figure>



<h1 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h1><h2 id="ss-命令"><a href="#ss-命令" class="headerlink" title="ss 命令"></a>ss 命令</h2><ul>
<li>socket statistic 的缩写</li>
<li>统计 Linux 系统中 socket 连接相关的信息<ul>
<li>可以显示更多关于 TCP和状态相关的信息</li>
<li>和 netstat 相比，ss 命令在跟踪 TCP 连接和套接字方面速度更快，功能更强大</li>
</ul>
</li>
</ul>
<p>选项</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>所有状态的套接字</td>
<td></td>
</tr>
<tr>
<td>-l</td>
<td>所有处于侦听状态（LISTEN）的套接字</td>
<td></td>
</tr>
<tr>
<td>-ua</td>
<td>Unix 套接字</td>
<td></td>
</tr>
<tr>
<td>-wa</td>
<td>Raw 套接字</td>
<td></td>
</tr>
<tr>
<td>-6a</td>
<td>所有 IPV6 套接字</td>
<td></td>
</tr>
<tr>
<td>-4a</td>
<td>所有 IPV4 套接字</td>
<td></td>
</tr>
<tr>
<td>-t</td>
<td>所有 TCP 套接字</td>
<td></td>
</tr>
<tr>
<td>-u</td>
<td>所有 UDP 套接字</td>
<td></td>
</tr>
<tr>
<td>-p</td>
<td>显示 进程名</td>
<td></td>
</tr>
<tr>
<td>-n</td>
<td>不解析服务名字，显示端口号</td>
<td></td>
</tr>
</tbody></table>
<p>输出列</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Netid</td>
<td>socket 类型</td>
<td></td>
</tr>
<tr>
<td>State</td>
<td>套接字处于什么状态</td>
<td>三次握手四次挥手的状态</td>
</tr>
<tr>
<td>Recv-Q</td>
<td>在 ESTAB 状态下，表示内核中还有多少字节的数据没有被上层应用读取</td>
<td>如果这里数值很大，应用程序可能发生了阻塞</td>
</tr>
<tr>
<td>Send-Q</td>
<td>在 ESTAB 状态下，表示内核发送队列中还有多少字节的数据没有收到确认的ACK</td>
<td>如果这个数值很大，表明接收端的接收以及处理需要加强</td>
</tr>
<tr>
<td>Local Address:Port</td>
<td>本地地址和端口</td>
<td></td>
</tr>
<tr>
<td>Peer Address:Port</td>
<td>远程地址和端口</td>
<td></td>
</tr>
</tbody></table>
<h3 id="统计-Socket-连接数量"><a href="#统计-Socket-连接数量" class="headerlink" title="统计 Socket 连接数量"></a>统计 Socket 连接数量</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss -a | wc -l</span><br></pre></td></tr></table></figure>

<h3 id="通过端口筛选"><a href="#通过端口筛选" class="headerlink" title="通过端口筛选"></a>通过端口筛选</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss -ap sport eq 3306</span><br></pre></td></tr></table></figure>

<h3 id="通过进程名筛选"><a href="#通过进程名筛选" class="headerlink" title="通过进程名筛选"></a>通过进程名筛选</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss -an sport eq mysql</span><br></pre></td></tr></table></figure>

<h3 id="通过IP地址筛选"><a href="#通过IP地址筛选" class="headerlink" title="通过IP地址筛选"></a>通过IP地址筛选</h3><p>通过目标地址筛选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss -a dst 27.38.240.99</span><br></pre></td></tr></table></figure>

<p>通过源地址筛选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss -a src 192.168.0.9</span><br></pre></td></tr></table></figure>



<h2 id="netstat-命令"><a href="#netstat-命令" class="headerlink" title="netstat 命令"></a>netstat 命令</h2><h1 id="CPU"><a href="#CPU" class="headerlink" title="CPU"></a>CPU</h1><h2 id="查看-CPU-的型号"><a href="#查看-CPU-的型号" class="headerlink" title="查看 CPU 的型号"></a>查看 CPU 的型号</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo | grep <span class="string">&#x27;model name&#x27;</span> | sort | uniq</span><br><span class="line"></span><br><span class="line">model name    : Intel(R) Xeon(R) CPU E5-2630 v4 @ 2.20GHz</span><br></pre></td></tr></table></figure>

<h2 id="查看-CPU-颗数"><a href="#查看-CPU-颗数" class="headerlink" title="查看 CPU 颗数"></a>查看 CPU 颗数</h2><p>插槽上的 CPU 个数, 物理 CPU 数量，可以数不重复的 <code>physical id</code> 个数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo | grep <span class="string">&#x27;physical id&#x27;</span> | sort | uniq | wc -l</span><br></pre></td></tr></table></figure>

<h2 id="查看-CPU-核数"><a href="#查看-CPU-核数" class="headerlink" title="查看 CPU 核数"></a>查看 CPU 核数</h2><p>一颗 CPU 上面能处理数据的芯片组的数量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo |grep <span class="string">&quot;cores&quot;</span>|uniq|awk <span class="string">&#x27;&#123;print $4&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="逻辑-CPU-核数"><a href="#逻辑-CPU-核数" class="headerlink" title="逻辑 CPU 核数"></a>逻辑 CPU 核数</h2><p>一般情况，我们认为一颗cpu可以有多核，加上intel的超线程技术(HT), 可以在逻辑上把一个物理线程模拟出两个线程来使用，使得单个核心用起来像两个核一样，以充分发挥CPU的性能</p>
<ul>
<li>逻辑CPU数量=物理cpu数量 x cpu cores 这个规格值 x 2(如果支持并开启超线程)</li>
<li>top命令查询出来的就是逻辑CPU的数量</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cpuinfo |grep <span class="string">&quot;processor&quot;</span>|wc -l</span><br></pre></td></tr></table></figure>

<h1 id="内存"><a href="#内存" class="headerlink" title="内存"></a>内存</h1><h2 id="free-命令"><a href="#free-命令" class="headerlink" title="free 命令"></a>free 命令</h2><ul>
<li>展示内存使用情况</li>
<li>展示了系统中空闲和已经使用了的物理内存、交换内存以及内核的缓冲区和页面缓存</li>
<li>所有展示的信息都是从 <code>/proc/meminfo</code> 文件解析出来的</li>
<li><strong>默认以 KB(kbytes) 为单位</strong></li>
</ul>
<p>选项</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>描述</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>-h</td>
<td>还有多少可用内存</td>
<td><strong>可用内存是 availabe 或者 free + buff/cache</strong></td>
</tr>
<tr>
<td>-t</td>
<td>显示物理内存和交换内存的总和</td>
<td></td>
</tr>
<tr>
<td>-s</td>
<td>每隔N秒输出一次</td>
<td></td>
</tr>
<tr>
<td>-c</td>
<td>重复输出N次</td>
<td></td>
</tr>
<tr>
<td>-w</td>
<td>buff 和 cache 分开显示</td>
<td></td>
</tr>
<tr>
<td>-b</td>
<td>以 Bytes 为单位输出</td>
<td>自动忽略小于对应单位的数值</td>
</tr>
<tr>
<td>-k</td>
<td>以 KB 为单位输出</td>
<td></td>
</tr>
<tr>
<td>-m</td>
<td>以 MB 为单位输出</td>
<td></td>
</tr>
<tr>
<td>-g</td>
<td>以 GB 为单位输出</td>
<td></td>
</tr>
</tbody></table>
<p>输出列</p>
<table>
<thead>
<tr>
<th>列</th>
<th>描述</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>total</td>
<td>总内存的大小</td>
<td></td>
</tr>
<tr>
<td>used</td>
<td>已经使用内存</td>
<td>计算方式是：<br />used = total - free - buff/cache</td>
</tr>
<tr>
<td>free</td>
<td>还没有使用的内存</td>
<td></td>
</tr>
<tr>
<td>shared</td>
<td>进程之间的共享内存</td>
<td></td>
</tr>
<tr>
<td>buff/cache</td>
<td>内核缓冲区和页面缓存</td>
<td>如果应用程序需要的话，可以随时回收这部分缓存<br />通过 <code>free -w</code> 命令可以分别显示 buff 和 cache 占用的内存</td>
</tr>
<tr>
<td>available</td>
<td>可用内存的预估大小</td>
<td>可以把 free 和 buff/cache 加起来看做 available 的近似值<br />free + buff/cache ≈ available</td>
</tr>
</tbody></table>
<h3 id="每隔-N-秒输出一次"><a href="#每隔-N-秒输出一次" class="headerlink" title="每隔 N 秒输出一次"></a>每隔 N 秒输出一次</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 直到按 Ctrl + Z 停止</span></span><br><span class="line">free -s 2</span><br></pre></td></tr></table></figure>

<h3 id="重复输出3次，输出每隔2秒"><a href="#重复输出3次，输出每隔2秒" class="headerlink" title="重复输出3次，输出每隔2秒"></a>重复输出3次，输出每隔2秒</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free -c 3 -s 2</span><br></pre></td></tr></table></figure>

<h1 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h1><h2 id="查看活动用户"><a href="#查看活动用户" class="headerlink" title="查看活动用户"></a>查看活动用户</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">w</span><br></pre></td></tr></table></figure>

<h1 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h1><h2 id="查看文件属性"><a href="#查看文件属性" class="headerlink" title="查看文件属性"></a>查看文件属性</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看文件属性</span></span><br><span class="line"><span class="built_in">stat</span> filename</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看文件修改时间</span></span><br><span class="line">ls -l filename</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看文件状态改动时间</span></span><br><span class="line">ls -lc filename</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看文件访问时间</span></span><br><span class="line">ls -lu filename</span><br></pre></td></tr></table></figure>

<ul>
<li>mtime： 最后一次修改文件或目录的时间<ul>
<li>modify time</li>
<li>修改 mtime 时，ctime 必须随着改变，因为文件大小是属性，会随着变</li>
<li>atime 不一定会变，可以不访问文件对其内容进行修改</li>
</ul>
</li>
<li>ctime： 最后一次改变文件或目录属性的时间<ul>
<li>change time</li>
</ul>
</li>
<li>atime： 最后一次访问文件或目录的时间<ul>
<li>access time</li>
</ul>
</li>
</ul>
<h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><h2 id="wc-命令"><a href="#wc-命令" class="headerlink" title="wc 命令"></a>wc 命令</h2><ul>
<li>Word Count 的缩写</li>
<li>统计单词数，单词之间是以一个或多个空格、制表符、换行符分隔开的</li>
<li>字母、数字、以及空格、制表符和换行符都计算在内</li>
</ul>
<p>选项</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>-l</td>
<td>行数</td>
<td></td>
</tr>
<tr>
<td>-c</td>
<td>字节数</td>
<td>与 <code>ls -lh</code> 输出的字节数相同</td>
</tr>
<tr>
<td>-m</td>
<td>字符数</td>
<td>一个汉字算两个字符</td>
</tr>
<tr>
<td>-L</td>
<td>所有行中字符数最多那一行的字符数</td>
<td></td>
</tr>
<tr>
<td>-w</td>
<td>统计单词数</td>
<td>以一个或多个空格、制表符、换行符作为分隔符<br />只要连续的字符之间出现空格、制表符、换行符中任一个字符，都当做两个单词</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="统计终端输入"><a href="#统计终端输入" class="headerlink" title="统计终端输入"></a>统计终端输入</h3><ul>
<li>终端上输入 wc 命令并回车</li>
<li>输入需要统计的字符</li>
<li>输入完最后按回车键</li>
<li>按 <code>Ctrl + D</code> 会输出统计的结果</li>
</ul>
<p><img src="images/414ea86c-3a66-4dd5-99c0-7701bd3f5908.gif" alt="img"></p>
<p>输出列: </p>
<p>2行、4个单词、12个字节</p>
<h3 id="统计行数"><a href="#统计行数" class="headerlink" title="统计行数"></a>统计行数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@centos-7]<span class="comment"># wc -l a.txt</span></span><br><span class="line">3 a.txt</span><br></pre></td></tr></table></figure>

<p>输出列：</p>
<p>总行数、文件名</p>
<h3 id="统计多个文件"><a href="#统计多个文件" class="headerlink" title="统计多个文件"></a>统计多个文件</h3><p>每个文件之间以空格隔开</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@centos-7]<span class="comment"># wc -w a.txt b.txt</span></span><br><span class="line"> 6 a.txt</span><br><span class="line"> 1 b.txt</span><br><span class="line"> 7 total</span><br></pre></td></tr></table></figure>

<h3 id="统计目录中对象数"><a href="#统计目录中对象数" class="headerlink" title="统计目录中对象数"></a>统计目录中对象数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@centos-7]<span class="comment"># ls | wc -l</span></span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<h3 id="查看-Linux-启动时间"><a href="#查看-Linux-启动时间" class="headerlink" title="查看 Linux 启动时间"></a>查看 Linux 启动时间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date -d &quot;$(awk -F. &#x27;&#123;print $1&#125;&#x27; /proc/uptime) second ago&quot; +&quot;%Y-%m-%d %H:%M:%S&quot;</span><br></pre></td></tr></table></figure>

<h3 id="查看-Linux-已运行时间"><a href="#查看-Linux-已运行时间" class="headerlink" title="查看 Linux 已运行时间"></a>查看 Linux 已运行时间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/uptime|awk -F. &#x27;&#123;run_days=$1 / 86400;run_hour=($1 % 86400)/3600;run_minute=($1 % 3600)/60;run_second=$1 % 60;printf(&quot;系统已运行：%d天%d时%d分%d 秒\n&quot;,run_days,run_hour,run_minute,run_second)&#125;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="查看-Linux-历史启动时间"><a href="#查看-Linux-历史启动时间" class="headerlink" title="查看 Linux 历史启动时间"></a>查看 Linux 历史启动时间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">last -n 20</span><br></pre></td></tr></table></figure>

<h3 id="一个网卡设置多个-IP"><a href="#一个网卡设置多个-IP" class="headerlink" title="一个网卡设置多个 IP"></a>一个网卡设置多个 IP</h3><ul>
<li><p><strong>临时设置，关机失效</strong></p>
</li>
<li><p>同网段的电脑可以 ping 通</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifconfig eth0:1 10.0.82.200 netmask 255.255.255.0</span><br><span class="line">ifconfig eth0:1 192.168.0.100 netmask 255.255.255.0</span><br></pre></td></tr></table></figure>

<h3 id="设置永久-IP"><a href="#设置永久-IP" class="headerlink" title="设置永久 IP"></a>设置永久 IP</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/sysconfig/network-scripts</span><br></pre></td></tr></table></figure>

<ol>
<li>创建新文件 vim ifcfg-eth0:0，添加以下内容，保存退出</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 虚拟网络接口，随意</span></span><br><span class="line">DEVICE=eth0:0</span><br><span class="line"><span class="comment"># 系统启动时激活</span></span><br><span class="line">ONBOOT=yes</span><br><span class="line"><span class="comment"># 使用静态 ip 地址</span></span><br><span class="line">BOOTPROTO=static</span><br><span class="line"><span class="comment"># 该虚拟网络接口的ip别名，随意</span></span><br><span class="line">IPADDR=192.168.1.100</span><br><span class="line"><span class="comment"># 子网掩码，对应ip别名</span></span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line"><span class="comment"># 网关，对应ip别名</span></span><br><span class="line">GATEWAY=192.168.1.1</span><br><span class="line"><span class="comment"># 网卡MAC地址，与 eth0 相同</span></span><br><span class="line">HWADDR=46:07:60:4f:92:e3</span><br><span class="line"><span class="comment"># 是否给予非root用户设备管理权限</span></span><br><span class="line">USERCTL=yes</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>重启网卡</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service network restart</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>临时清除ip别名</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig eth0:0 down</span><br></pre></td></tr></table></figure>

<h2 id="CentOS-关闭防火墙"><a href="#CentOS-关闭防火墙" class="headerlink" title="CentOS 关闭防火墙"></a>CentOS 关闭防火墙</h2><h3 id="修改-etc-sysconfig-selinux-文件"><a href="#修改-etc-sysconfig-selinux-文件" class="headerlink" title="修改 /etc/sysconfig/selinux 文件"></a>修改 /etc/sysconfig/selinux 文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># vi  /etc/sysconfig/selinux</span></span><br></pre></td></tr></table></figure>

<p>找到防火墙设置语句 SELINUX=disabled 或 SELINUX=enforcing，</p>
<ul>
<li>如果是 disable 则不用修改直接输入：q!退出。</li>
<li>如果是 enforcing 则将光标移动至字母e上，按x键，将该单词删除，再按a键，进入Insert模式，输入disabled</li>
</ul>
<p>编辑结束后，按esc键，输入 :wq，保存退出</p>
<h3 id="重启系统，使修改生效"><a href="#重启系统，使修改生效" class="headerlink" title="重启系统，使修改生效"></a>重启系统，使修改生效</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># reboot</span></span><br></pre></td></tr></table></figure>

<h3 id="查看防火墙状态"><a href="#查看防火墙状态" class="headerlink" title="查看防火墙状态"></a>查看防火墙状态</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@database ~]<span class="comment"># service iptables status</span></span><br><span class="line">Table: filter</span><br><span class="line">Chain INPUT (policy ACCEPT)</span><br><span class="line">num  target     prot opt <span class="built_in">source</span>               destination         </span><br><span class="line">1    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED </span><br><span class="line">2    ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0           </span><br><span class="line">3    ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           </span><br><span class="line">4    ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0           state NEW tcp dpt:22 </span><br><span class="line">5    REJECT     all  --  0.0.0.0/0            0.0.0.0/0           reject-with icmp-host-prohibited </span><br><span class="line"></span><br><span class="line">Chain FORWARD (policy ACCEPT)</span><br><span class="line">num  target     prot opt <span class="built_in">source</span>               destination         </span><br><span class="line">1    REJECT     all  --  0.0.0.0/0            0.0.0.0/0           reject-with icmp-host-prohibited </span><br><span class="line"></span><br><span class="line">Chain OUTPUT (policy ACCEPT)</span><br><span class="line">num  target     prot opt <span class="built_in">source</span>               destination    </span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果发现仍然有 ACCEPT 和 REJECT 列表，则说明配置没有生效，解决办法，手动执行：</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@database ~]<span class="comment"># service iptables stop</span></span><br><span class="line">iptables: Flushing firewall rules:                         [  OK  ]</span><br><span class="line">iptables: Setting chains to policy ACCEPT: filter          [  OK  ]</span><br><span class="line">iptables: Unloading modules:                               [  OK  ]</span><br></pre></td></tr></table></figure>
        
    </div>
    </div>

    <div class="article-badge">
        
        
    </div>

</div>

<footer class="article-footer">
    <div class="article-more-info">
    <div class="article-date">
  <time datetime="2021-04-25T04:42:42.641Z" itemprop="datePublished">2021-04-25</time>
</div>
    
        <div class="article-category">
        <a class="article-category-link" href="/categories/Linux/">Linux</a>
        </div>
    
    
        <div class="article-tag">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%9F%E6%9F%A5/" rel="tag">速查</a></li></ul>
        </div>
    
    </div>
</footer>

</article>

    
  
    
      <article
id="post-Linux/Linux 忘记 root 密码"
class="article article-type-post"
>



<div class="article-inner">
    

    <div class="article-body">
    <header class="article-title">
        <a href="/Linux/Linux%20%E5%BF%98%E8%AE%B0%20root%20%E5%AF%86%E7%A0%81/">Linux 忘记 root 密码</a>
    </header>
    <div class="article-entry post-inner-html">
        
        <h2 id="Linux-忘记-root-密码"><a href="#Linux-忘记-root-密码" class="headerlink" title="Linux 忘记 root 密码"></a>Linux 忘记 root 密码</h2><h3 id="rd-break方法"><a href="#rd-break方法" class="headerlink" title="rd.break方法"></a>rd.break方法</h3><ol>
<li>启动的时候，在启动界面，相应启动项，内核名称上按 “e”；</li>
<li>进入后，找到 linux16 开头的地方，按 “end” 键到最后，输入 rd.break，按 ctrl+x 进入；</li>
<li>进. 后输入命令 <code>mount</code>，发现根为 /sysroot/，并且不能写，只有 ro=readonly 权限；</li>
<li><code>mount -o remount,rw /sysroot/</code>，重新挂载，之后 mount，发现有了 r,w 权限；</li>
<li><code>chroot /sysroot/</code> 改变根；<ul>
<li><code>echo redhat|passwd –stdin root</code> 修改 root 密码为 redhat，或者输入 passwd，交互修改；</li>
<li>还有就是先 cp 一份，然后修改 /etc/shadow 文件</li>
</ul>
</li>
<li><code>touch /.autorelabel</code> 这句是为了 selinux 生效</li>
<li><code>ctrl+d</code> 退出</li>
<li>然后 reboot</li>
</ol>

        
    </div>
    </div>

    <div class="article-badge">
        
        
    </div>

</div>

<footer class="article-footer">
    <div class="article-more-info">
    <div class="article-date">
  <time datetime="2021-04-25T04:41:57.000Z" itemprop="datePublished">2021-04-25</time>
</div>
    
        <div class="article-category">
        <a class="article-category-link" href="/categories/Linux/">Linux</a>
        </div>
    
    
        <div class="article-tag">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" rel="tag">异常处理</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%9F%E6%9F%A5/" rel="tag">速查</a></li></ul>
        </div>
    
    </div>
</footer>

</article>

    
  
    
      <article
id="post-Java/JDK8 Stream 常用方法"
class="article article-type-post"
>



<div class="article-inner">
    

    <div class="article-body">
    <header class="article-title">
        <a href="/Java/JDK8%20Stream%20%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/">JDK8 Stream 常用方法</a>
    </header>
    <div class="article-entry post-inner-html">
        
        <h3 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h3><p><strong>首先创建一个对象</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">double</span> salary;</span><br><span class="line">  <span class="keyword">private</span> Status status;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">Status</span> </span>&#123;</span><br><span class="line">    FREE, BUSY, VOCATION;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">(<span class="keyword">int</span> id, String name, <span class="keyword">int</span> age, <span class="keyword">double</span> salary, Status status)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.id = id;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.salary = salary;</span><br><span class="line">    <span class="keyword">this</span>.status = status;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//省略get，set等。。。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>随便初始化一些数据</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Employee&gt; empList = Arrays.asList(</span><br><span class="line">    <span class="keyword">new</span> Employee(<span class="number">101</span>, <span class="string">&quot;张三&quot;</span>, <span class="number">18</span>, <span class="number">9999.99</span>, Status.FREE),</span><br><span class="line">    <span class="keyword">new</span> Employee(<span class="number">102</span>, <span class="string">&quot;李四&quot;</span>, <span class="number">59</span>, <span class="number">6666.66</span>, Status.BUSY),</span><br><span class="line">    <span class="keyword">new</span> Employee(<span class="number">103</span>, <span class="string">&quot;王五&quot;</span>, <span class="number">28</span>, <span class="number">3333.33</span>, Status.VOCATION),</span><br><span class="line">    <span class="keyword">new</span> Employee(<span class="number">104</span>, <span class="string">&quot;赵六&quot;</span>, <span class="number">8</span>, <span class="number">7777.77</span>, Status.BUSY),</span><br><span class="line">    <span class="keyword">new</span> Employee(<span class="number">104</span>, <span class="string">&quot;赵六&quot;</span>, <span class="number">8</span>, <span class="number">7777.77</span>, Status.FREE),</span><br><span class="line">    <span class="keyword">new</span> Employee(<span class="number">104</span>, <span class="string">&quot;赵六&quot;</span>, <span class="number">8</span>, <span class="number">7777.77</span>, Status.FREE),</span><br><span class="line">    <span class="keyword">new</span> Employee(<span class="number">105</span>, <span class="string">&quot;田七&quot;</span>, <span class="number">38</span>, <span class="number">5555.55</span>, Status.BUSY));</span><br></pre></td></tr></table></figure>

<h4 id="中间操作"><a href="#中间操作" class="headerlink" title="中间操作"></a><strong>中间操作</strong></h4><h5 id="根据条件筛选-filter"><a href="#根据条件筛选-filter" class="headerlink" title="根据条件筛选 filter"></a><strong>根据条件筛选 filter</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 接收Lambda, 从流中排除某些元素。</span></span><br><span class="line"><span class="comment">*/</span><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  empList.stream().filter((e) -&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> e.getSalary() &gt;= <span class="number">5000</span>;</span><br><span class="line">  &#125;).forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="跳过流的前n个元素-skip"><a href="#跳过流的前n个元素-skip" class="headerlink" title="跳过流的前n个元素 skip"></a><strong>跳过流的前n个元素 skip</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 跳过元素，返回一个扔掉了前n个元素的流。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testSkip</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  empList.stream().filter((e) -&gt; e.getSalary() &gt;= <span class="number">5000</span>).skip(<span class="number">2</span>).forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="去除重复元素-distinct"><a href="#去除重复元素-distinct" class="headerlink" title="去除重复元素 distinct"></a><strong>去除重复元素 distinct</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 筛选，通过流所生成元素的 hashCode() 和 equals() 去除重复元素</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testDistinct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  empList.stream().distinct().forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="截取流的前n个元素-limit"><a href="#截取流的前n个元素-limit" class="headerlink" title="截取流的前n个元素 limit"></a><strong>截取流的前n个元素 limit</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 截断流，使其元素不超过给定数量。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testLimit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  empList.stream().filter((e) -&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> e.getSalary() &gt;= <span class="number">5000</span>;</span><br><span class="line">  &#125;).limit(<span class="number">3</span>).forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="映射-map"><a href="#映射-map" class="headerlink" title="映射 map"></a><strong>映射 map</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 接收一个函数作为参数，该函数会被应用到每个元素上，并将其映射成一个新的元素</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  empList.stream().map(e -&gt; e.getName()).forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">  empList.stream().map(e -&gt; &#123;</span><br><span class="line">    empList.forEach(i -&gt; &#123;</span><br><span class="line">      i.setName(i.getName() + <span class="string">&quot;111&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> e;</span><br><span class="line">  &#125;).collect(Collectors.toList());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="自然排序-sorted"><a href="#自然排序-sorted" class="headerlink" title="自然排序 sorted"></a><strong>自然排序 sorted</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 产生一个新流，其中按自然顺序排序</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testSorted</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  empList.stream().map(Employee::getName).sorted().forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="自定义排序-sorted-Comparator-comp"><a href="#自定义排序-sorted-Comparator-comp" class="headerlink" title="自定义排序 sorted(Comparator comp)"></a><strong>自定义排序 sorted(Comparator comp)</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 产生一个新流，其中按自然顺序排序</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testSortedComparator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  empList.stream().sorted((x, y) -&gt; &#123;</span><br><span class="line">   <span class="keyword">if</span> (x.getAge() == y.getAge()) &#123;</span><br><span class="line">     <span class="keyword">return</span> x.getName().compareTo(y.getName());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> Integer.compare(x.getAge(), y.getAge());</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;).forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="最终操作"><a href="#最终操作" class="headerlink" title="最终操作"></a><strong>最终操作</strong></h4><h5 id="是否匹配任一元素-anyMatch"><a href="#是否匹配任一元素-anyMatch" class="headerlink" title="是否匹配任一元素 anyMatch"></a><strong>是否匹配任一元素 anyMatch</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查是否至少匹配一个元素</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testAnyMatch</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">boolean</span> b = empList.stream().anyMatch((e) -&gt; e.getStatus().equals(Status.BUSY));</span><br><span class="line">  System.out.println(<span class="string">&quot;boolean is : &quot;</span> + b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="是否匹配所有元素-allMatch"><a href="#是否匹配所有元素-allMatch" class="headerlink" title="是否匹配所有元素 allMatch"></a><strong>是否匹配所有元素 allMatch</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查是否匹配所有元素</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testAllMatch</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">boolean</span> b = empList.stream().allMatch((e) -&gt; e.getStatus().equals(Status.BUSY));</span><br><span class="line">  System.out.println(<span class="string">&quot;boolean is : &quot;</span> + b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="是否未匹配所有元素-noneMatch"><a href="#是否未匹配所有元素-noneMatch" class="headerlink" title="是否未匹配所有元素 noneMatch"></a><strong>是否未匹配所有元素 noneMatch</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检查是否没有匹配的元素</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testNoneMatch</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">boolean</span> b = empList.stream().noneMatch((e) -&gt; e.getStatus().equals(Status.BUSY));</span><br><span class="line">  System.out.println(<span class="string">&quot;boolean is : &quot;</span> + b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="返回第一个元素-findFirst"><a href="#返回第一个元素-findFirst" class="headerlink" title="返回第一个元素 findFirst"></a><strong>返回第一个元素 findFirst</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回第一个元素</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testFindFirst</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Optional&lt;Employee&gt; op = empList.stream()</span><br><span class="line">            .sorted((e1, e2) -&gt; Double.compare(e1.getSalary(), e2.getSalary()))</span><br><span class="line">            .findFirst();</span><br><span class="line">    <span class="keyword">if</span> (op.isPresent()) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;first employee name is : &quot;</span> + op.get().getName().toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="返回流中任意元素-findAny"><a href="#返回流中任意元素-findAny" class="headerlink" title="返回流中任意元素 findAny"></a><strong>返回流中任意元素 findAny</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回当前流中的任意元素</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testFindAny</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Optional&lt;Employee&gt; op = empList.stream()</span><br><span class="line">            .sorted((e1, e2) -&gt; Double.compare(e1.getSalary(), e2.getSalary()))</span><br><span class="line">            .findAny();</span><br><span class="line">    <span class="keyword">if</span> (op.isPresent()) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;any employee name is : &quot;</span> + op.get().getName().toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="返回流的总数-count"><a href="#返回流的总数-count" class="headerlink" title="返回流的总数 count"></a><strong>返回流的总数 count</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回流中元素的总个数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">long</span> count = empList.stream().filter((e) -&gt; e.getStatus().equals(Status.FREE)).count();</span><br><span class="line">  System.out.println(<span class="string">&quot;Count is : &quot;</span> + count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="返回流中的最大值-max"><a href="#返回流中的最大值-max" class="headerlink" title="返回流中的最大值 max"></a><strong>返回流中的最大值 max</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回流中最大值</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testMax</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Optional&lt;Double&gt; op = empList.stream().map(Employee::getSalary).max(Double::compare);</span><br><span class="line">  System.out.println(op.get());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="返回流中的最小值-min"><a href="#返回流中的最小值-min" class="headerlink" title="返回流中的最小值 min"></a><strong>返回流中的最小值 min</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 返回流中最小值</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testMin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Optional&lt;Employee&gt; op2 = empList.stream().min((e1, e2) -&gt; Double.compare(e1.getSalary(), e2.getSalary()));</span><br><span class="line">  System.out.println(op2.get());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="归约-reduce"><a href="#归约-reduce" class="headerlink" title="归约 reduce"></a><strong>归约 reduce</strong></h5><p><strong>归约是将集合中的所有元素经过指定运算，折叠成一个元素输出</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 可以将流中元素反复结合起来，得到一个值。返回T</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testReduce</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Optional&lt;Double&gt; op = empList.stream().map(Employee::getSalary).reduce(Double::sum);</span><br><span class="line"></span><br><span class="line">  System.out.println(op.get());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 可以将流中元素反复结合起来，得到一个值，返回Optional&lt; T&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testReduce1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Optional&lt;Integer&gt; sum = empList.stream().map(Employee::getName).flatMap(Java8Stream::filterCharacter)</span><br><span class="line">      .map((ch) -&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (ch.equals(<span class="string">&#x27;六&#x27;</span>))</span><br><span class="line">          <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;).reduce(Integer::sum);</span><br><span class="line">  System.out.println(sum.get());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="将元素收集到-list-里-Collectors-toList"><a href="#将元素收集到-list-里-Collectors-toList" class="headerlink" title="将元素收集到 list 里 Collectors.toList()"></a><strong>将元素收集到 list 里 Collectors.toList()</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 把流中的元素收集到list里。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testCollectorsToList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  List&lt;String&gt; list = empList.stream().map(Employee::getName).collect(Collectors.toList());</span><br><span class="line">  list.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="将元素收集到-set-里-Collectors-toSet"><a href="#将元素收集到-set-里-Collectors-toSet" class="headerlink" title="将元素收集到 set 里 Collectors.toSet()"></a><strong>将元素收集到 set 里 Collectors.toSet()</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 把流中的元素收集到set里。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testCollectorsToSet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Set&lt;String&gt; list = empList.stream().map(Employee::getName).collect(Collectors.toSet());</span><br><span class="line">  list.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="把流中的元素收集到新创建的集合里-Collectors-toCollection-HashSet-new"><a href="#把流中的元素收集到新创建的集合里-Collectors-toCollection-HashSet-new" class="headerlink" title="把流中的元素收集到新创建的集合里 Collectors.toCollection(HashSet::new)"></a><strong>把流中的元素收集到新创建的集合里</strong> <strong>Collectors.toCollection(HashSet::new)</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 把流中的元素收集到新创建的集合里。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testCollectorsToCollection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  HashSet&lt;String&gt; hs = empList.stream().map(Employee::getName).collect(Collectors.toCollection(HashSet::<span class="keyword">new</span>));</span><br><span class="line">  hs.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="根据比较器选择最大值-Collectors-maxBy"><a href="#根据比较器选择最大值-Collectors-maxBy" class="headerlink" title="根据比较器选择最大值 Collectors.maxBy()"></a><strong>根据比较器选择最大值 Collectors.maxBy()</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据比较器选择最大值。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testCollectorsMaxBy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Optional&lt;Double&gt; max = empList.stream().map(Employee::getSalary).collect(Collectors.maxBy(Double::compare));</span><br><span class="line">  System.out.println(max.get());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="根据比较器选择最小值-Collectors-minBy"><a href="#根据比较器选择最小值-Collectors-minBy" class="headerlink" title="根据比较器选择最小值 Collectors.minBy()"></a><strong>根据比较器选择最小值 Collectors.minBy()</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据比较器选择最小值。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testCollectorsMinBy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Optional&lt;Double&gt; max = empList.stream().map(Employee::getSalary).collect(Collectors.minBy(Double::compare));</span><br><span class="line">  System.out.println(max.get());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="对流中元素的某个字段求和-Collectors-summingDouble"><a href="#对流中元素的某个字段求和-Collectors-summingDouble" class="headerlink" title="对流中元素的某个字段求和 Collectors.summingDouble()"></a><strong>对流中元素的某个字段求和 Collectors.summingDouble()</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 对流中元素的整数属性求和。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testCollectorsSummingDouble</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Double sum = empList.stream().collect(Collectors.summingDouble(Employee::getSalary));</span><br><span class="line">  System.out.println(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="对流中元素的某个字段求平均值-Collectors-averagingDouble"><a href="#对流中元素的某个字段求平均值-Collectors-averagingDouble" class="headerlink" title="对流中元素的某个字段求平均值 Collectors.averagingDouble()"></a><strong>对流中元素的某个字段求平均值 Collectors.averagingDouble()</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 计算流中元素Integer属性的平均值。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testCollectorsAveragingDouble</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Double avg = empList.stream().collect(Collectors.averagingDouble(Employee::getSalary));</span><br><span class="line">  System.out.println(avg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="分组-Collectors-groupingBy"><a href="#分组-Collectors-groupingBy" class="headerlink" title="分组 Collectors.groupingBy"></a><strong>分组 Collectors.groupingBy</strong></h5><p>类似sql的 group by</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 分组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testCollectorsGroupingBy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Map&lt;Status, List&lt;Employee&gt;&gt; map = empList.stream().collect(Collectors.groupingBy(Employee::getStatus));</span><br><span class="line"></span><br><span class="line">  System.out.println(map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="多级分组"><a href="#多级分组" class="headerlink" title="多级分组"></a><strong>多级分组</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 多级分组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testCollectorsGroupingBy1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Map&lt;Status, Map&lt;String, List&lt;Employee&gt;&gt;&gt; map = empList.stream()</span><br><span class="line">      .collect(Collectors.groupingBy(Employee::getStatus, Collectors.groupingBy((e) -&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (e.getAge() &gt;= <span class="number">60</span>)</span><br><span class="line">          <span class="keyword">return</span> <span class="string">&quot;老年&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (e.getAge() &gt;= <span class="number">35</span>)</span><br><span class="line">          <span class="keyword">return</span> <span class="string">&quot;中年&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          <span class="keyword">return</span> <span class="string">&quot;成年&quot;</span>;</span><br><span class="line">      &#125;)));</span><br><span class="line">  System.out.println(map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="字符串拼接-Collectors-joining"><a href="#字符串拼接-Collectors-joining" class="headerlink" title="字符串拼接 Collectors.joining()"></a><strong>字符串拼接 Collectors.joining()</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 字符串拼接</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testCollectorsJoining</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  String str = empList.stream().map(Employee::getName).collect(Collectors.joining(<span class="string">&quot;,&quot;</span>, <span class="string">&quot;----&quot;</span>, <span class="string">&quot;----&quot;</span>));</span><br><span class="line">  System.out.println(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Stream&lt;Character&gt; <span class="title">filterCharacter</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  List&lt;Character&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  <span class="keyword">for</span> (Character ch : str.toCharArray()) &#123;</span><br><span class="line">    list.add(ch);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> list.stream();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        
    </div>
    </div>

    <div class="article-badge">
        
        
    </div>

</div>

<footer class="article-footer">
    <div class="article-more-info">
    <div class="article-date">
  <time datetime="2021-04-25T04:40:44.571Z" itemprop="datePublished">2021-04-25</time>
</div>
    
        <div class="article-category">
        <a class="article-category-link" href="/categories/Java/">Java</a>
        </div>
    
    
        <div class="article-tag">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%80%9F%E6%9F%A5/" rel="tag">速查</a></li></ul>
        </div>
    
    </div>
</footer>

</article>

    
  
    
      <article
id="post-C++/C++ 标准模板库 STL"
class="article article-type-post"
>



<div class="article-inner">
    

    <div class="article-body">
    <header class="article-title">
        <a href="/C++/C++%20%E6%A0%87%E5%87%86%E6%A8%A1%E6%9D%BF%E5%BA%93%20STL/">C++ 标准模板库 STL</a>
    </header>
    <div class="article-entry post-inner-html">
        
        <p>[TOC]</p>
<h1 id="STL（standard-template-library）"><a href="#STL（standard-template-library）" class="headerlink" title="STL（standard template library）"></a>STL（standard template library）</h1><ul>
<li><p>标准模板库</p>
</li>
<li><p>一套功能强大的 C++ 模板类，</p>
</li>
<li><p>提供了通用的模板类和函数，这些模板类和函数可以实现多种流行和常用的算法和数据结构，如向量、链表、队列、栈。</p>
</li>
</ul>
<h2 id="STL-组成结构（6个）"><a href="#STL-组成结构（6个）" class="headerlink" title="STL 组成结构（6个）"></a>STL 组成结构（6个）</h2><table>
<thead>
<tr>
<th align="left">组件</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">容器（Containers）</td>
<td align="left">一些封装数据结构的模板类。<br />容器是用来管理某一类对象的集合。<br />C++ 提供了各种不同类型的容器，比如 deque、list、vector、map 等。</td>
</tr>
<tr>
<td align="left">算法（Algorithms）</td>
<td align="left">算法作用于容器。<br />它们提供了执行各种操作的方式，包括对容器内容执行初始化、排序、搜索和转换等操作。<br />STL 提供了非常多（大约 100 个）的数据结构算法，它们都被设计成一个个的模板函数<br />这些算法在 std 命名空间中定义，其中大部分算法都包含在头文件 <code>&lt;algorithm&gt;</code> 中，少部分位于头文件  <code>&lt;numeric&gt;</code> 中</td>
</tr>
<tr>
<td align="left">迭代器（Iterators）</td>
<td align="left">容器和算法之间的胶合剂。<br />对容器中数据的读和写，是通过迭代器完成的。<br />迭代器用于遍历对象集合的元素。<br />这些集合可能是容器，也可能是容器的子集。</td>
</tr>
<tr>
<td align="left">函数对象</td>
<td align="left">如果一个类将 () 运算符重载为成员函数，这个类就称为函数对象类，<br />这个类的对象就是函数对象（又称仿函数）。</td>
</tr>
<tr>
<td align="left">适配器</td>
<td align="left">可以使一个类的接口（模板的参数）适配成用户指定的形式，从而让原本不能在一起工作的两个类工作在一起。<br />值得一提的是，容器、迭代器和函数都有适配器。</td>
</tr>
<tr>
<td align="left">内存分配器</td>
<td align="left">为容器类模板提供自定义的内存申请和释放功能，<br />往往只有高级用户才有改变内存分配策略的需求，因此内存分配器对于一般用户来说，<br />并不常用。</td>
</tr>
</tbody></table>
<h2 id="STL-头文件（13个）"><a href="#STL-头文件（13个）" class="headerlink" title="STL 头文件（13个）"></a>STL 头文件（13个）</h2><ul>
<li>按照 C++ 标准库的规定，所有标准头文件都不再有扩展名</li>
</ul>
<p><code>&lt;iterator&gt;</code><br><code>&lt;functional&gt;</code><br><code>&lt;vector&gt;</code><br><code>&lt;deque&gt;</code><br><code>&lt;list&gt;</code><br><code>&lt;queue&gt;</code><br><code>&lt;stack&gt;</code><br><code>&lt;set&gt;</code><br><code>&lt;map&gt;</code><br><code>&lt;algorithm&gt;</code><br><code>&lt;numeric&gt;</code><br><code>&lt;memory&gt;</code><br><code>&lt;utility&gt;</code></p>
<table>
<thead>
<tr>
<th>复杂度</th>
<th>复杂度</th>
<th>元素个数</th>
<th>元素个数</th>
<th>元素个数</th>
<th>元素个数</th>
<th>元素个数</th>
<th>元素个数</th>
<th>元素个数</th>
<th>元素个数</th>
</tr>
</thead>
<tbody><tr>
<td>种类</td>
<td>大 O 表示</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>10</td>
<td>50</td>
<td>100</td>
<td>1 000</td>
<td>10 000</td>
</tr>
<tr>
<td>常量阶</td>
<td>O(1)</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>对数阶</td>
<td>O(log(n))</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>6</td>
<td>7</td>
<td>10</td>
<td>13</td>
</tr>
<tr>
<td>线性阶</td>
<td>O(n)</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>10</td>
<td>50</td>
<td>100</td>
<td>1 000</td>
<td>10 000</td>
</tr>
<tr>
<td>2次方</td>
<td>O(n2)</td>
<td>1</td>
<td>4</td>
<td>25</td>
<td>100</td>
<td>2500</td>
<td>10 000</td>
<td>1 000 000</td>
<td>100 000 000</td>
</tr>
</tbody></table>
<h1 id="STL-容器"><a href="#STL-容器" class="headerlink" title="STL 容器"></a>STL 容器</h1><ul>
<li><p>一些模板类的集合，<code>容器中封装的是组织数据的方法（也就是数据结构）</code></p>
</li>
<li><p>合理组织数据的存取与选择处理数据的算法同等重要</p>
</li>
<li><p>存取数据的方式往往会直接影响到对它们进行增删改查操作的复杂程度和时间消耗</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>容器种类</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>序列容器</td>
<td>主要包括 vector 向量容器、list 列表容器以及 deque 双端队列容器。<br />之所以被称为序列容器，是因为元素在容器中的位置同元素的值无关，即容器不是排序的。<br />将元素插入容器时，指定在什么位置，元素就会位于什么位置。</td>
</tr>
<tr>
<td>排序容器</td>
<td>包括 set 集合容器、multiset 多重集合容器、map 映射容器以及 multimap 多重映射容器。<br />排序容器中的元素默认是由小到大排序好的，即便是插入元素，元素也会插入到适当位置。所以关联容器在查找时具有非常好的性能。</td>
</tr>
<tr>
<td>哈希容器</td>
<td>C++ 11新加入 4 种关联式容器，<br />分别是 unordered_set 哈希集合、unordered_multiset 哈希多重集合、unordered_map 哈希映射以及 unordered_multimap 哈希多重映射。<br />和排序容器不同，哈希容器中的元素是未排序的，元素的位置由哈希函数确定。</td>
</tr>
</tbody></table>
<blockquote>
<p>哈希容器直到 C++ 11 才被正式纳入 C++ 标准程序库</p>
</blockquote>
<h2 id="序列容器"><a href="#序列容器" class="headerlink" title="序列容器"></a>序列容器</h2><p><img src="http://doc.cloudcollect.cc/upload/2021/04/image-b6594d5ebf4e4a229cca1a664f17019e.png" alt="image.png"></p>
<h3 id="array-lt-T-N-gt-（数组容器）"><a href="#array-lt-T-N-gt-（数组容器）" class="headerlink" title="array&lt;T,N&gt;（数组容器）"></a>array&lt;T,N&gt;（数组容器）</h3><p><img src="http://doc.cloudcollect.cc/upload/2021/04/image-37c9cc2d11484e309645914285540adb.png" alt="image.png"></p>
<ul>
<li>可以存储 N 个 T 类型的元素</li>
<li>一旦建立，其长度固定不变</li>
<li>不能增加或删除元素，只能改变某个元素的值</li>
</ul>
<h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> std&#123;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">size_t</span> N&gt;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">array</span>;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="初始化方式"><a href="#初始化方式" class="headerlink" title="初始化方式"></a>初始化方式</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方式一（不推荐）</span></span><br><span class="line"><span class="comment">// 由于未显式指定这 10 个元素的值，</span></span><br><span class="line"><span class="comment">// 各个元素的值是不确定的（array 容器不会做默认初始化操作）</span></span><br><span class="line">std::array&lt;<span class="keyword">double</span>, 10&gt; values;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式二</span></span><br><span class="line"><span class="comment">// 所有的元素初始化为 0 或者和默认元素类型等效的值</span></span><br><span class="line">std::array&lt;<span class="keyword">double</span>, 10&gt; values &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式三</span></span><br><span class="line"><span class="comment">// 初始化了前 4 个元素，剩余的元素都会被初始化为 0.0</span></span><br><span class="line">std::array&lt;<span class="keyword">double</span>, 10&gt; values &#123;<span class="number">0.5</span>,<span class="number">1.0</span>,<span class="number">1.5</span>,<span class="number">2.0</span>&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="vector（向量容器）"><a href="#vector（向量容器）" class="headerlink" title="vector（向量容器）"></a>vector<T>（向量容器）</h3><p><img src="http://doc.cloudcollect.cc/upload/2021/04/image-bdd60d806a5a44da83fc3420cc65eca2.png" alt="image.png"></p>
<ul>
<li>存放 T 类型的元素</li>
<li>长度可变，存储空间不足时，会自动申请更多的内存</li>
<li>在尾部增加或删除元素的效率最高<ul>
<li>时间复杂度为 O(1) 常数阶</li>
</ul>
</li>
<li>在其它位置插入或删除元素效率较差<ul>
<li>时间复杂度为 O(n) 线性阶，其中 n 为容器中元素的个数</li>
</ul>
</li>
</ul>
<h3 id="deque（双端队列容器）"><a href="#deque（双端队列容器）" class="headerlink" title="deque（双端队列容器）"></a>deque<T>（双端队列容器）</h3><p><img src="http://doc.cloudcollect.cc/upload/2021/04/image-8c001be15c2147108630d62d09e7fa30.png" alt="image.png"></p>
<ul>
<li>和 vector 非常相似</li>
<li>不仅尾部插入和删除元素高效，在头部插入或删除元素也同样高效<ul>
<li>时间复杂度都是 O(1) 常数阶</li>
</ul>
</li>
<li>在容器中某一位置处插入或删除元素效率较差<ul>
<li>时间复杂度为 O(n) 线性阶</li>
</ul>
</li>
</ul>
<h3 id="list（链表容器）"><a href="#list（链表容器）" class="headerlink" title="list（链表容器）"></a>list<T>（链表容器）</h3><p><img src="http://doc.cloudcollect.cc/upload/2021/04/image-830cb0b8cd55496aa134cc49df823c01.png" alt="image.png"></p>
<ul>
<li>存放 T 类型的元素</li>
<li>长度可变，存储空间不足时，会自动申请更多的内存</li>
<li><code>以双向链表的形式组织元素</code></li>
<li>序列的任何地方都可以高效地增加或删除元素<ul>
<li>时间复杂度都为常数阶 O(1)</li>
</ul>
</li>
<li>访问容器中任意元素的速度要比前三种容器慢<ul>
<li>因为 list<T> 必须从第一个元素或最后一个元素开始访问，需要沿着链表移动，直到到达想要的元素</li>
</ul>
</li>
</ul>
<h3 id="forward-list（正向链表容器）"><a href="#forward-list（正向链表容器）" class="headerlink" title="forward_list（正向链表容器）"></a>forward_list<T>（正向链表容器）</h3><p><img src="http://doc.cloudcollect.cc/upload/2021/04/image-15e3f0818a834d7ea8869bb014a70122.png" alt="image.png"></p>
<ul>
<li>和 list 容器非常类似</li>
<li><code>以单链表的形式组织元素</code></li>
<li>只能从第一个元素开始访问</li>
<li>比链表容器快、更节省内存</li>
</ul>
<h1 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h1><ul>
<li>将容器和算法分开</li>
<li>遍历读写容器数据</li>
<li>隐藏容器内部差异，以统一的界面面向算法传送数据</li>
</ul>
<h2 id="5-种迭代器"><a href="#5-种迭代器" class="headerlink" title="5 种迭代器"></a>5 种迭代器</h2><ul>
<li>输入迭代器</li>
<li>输出迭代器</li>
<li>前向迭代器（forward iterator）<ul>
<li>支持 ++p，p++ 操作</li>
<li>支持 *p 操作</li>
<li>可以被复制</li>
<li>可以被赋值</li>
<li>可以用 == 和 != 运算符进行比较</li>
<li>两个正向迭代器可以互相赋值</li>
</ul>
</li>
<li>双向迭代器（bidirectional iterator）<ul>
<li>具有正向迭代器的全部功能</li>
<li>可以进行 –p 或者 p– 操作（即一次向后移动一个位置）</li>
</ul>
</li>
<li>随机访问迭代器（random access iterator）<ul>
<li>具有双向迭代器的全部功能</li>
<li>可以用 &lt;、&gt;、&lt;=、&gt;= 运算符进行比较</li>
<li>p2-p1： 返回值表示 p2 所指向元素和 p1 所指向元素的序号之差（也可以说是 p2 和 p1 之间的元素个数减一）</li>
<li>p+=i：使得 p 往后移动 i 个元素。</li>
<li>p-=i：使得 p 往前移动 i 个元素。</li>
<li>p+i：返回 p 后面第 i 个元素的迭代器。</li>
<li>p-i：返回 p 前面第 i 个元素的迭代器。</li>
<li>p[i]：返回 p 后面第 i 个元素的引用。</li>
</ul>
</li>
</ul>
<h2 id="不同容器的迭代器"><a href="#不同容器的迭代器" class="headerlink" title="不同容器的迭代器"></a>不同容器的迭代器</h2><table>
<thead>
<tr>
<th>容器</th>
<th>对应的迭代器类型</th>
</tr>
</thead>
<tbody><tr>
<td>array</td>
<td>随机访问迭代器</td>
</tr>
<tr>
<td>vector</td>
<td>随机访问迭代器</td>
</tr>
<tr>
<td>deque</td>
<td>随机访问迭代器</td>
</tr>
<tr>
<td>list</td>
<td>双向迭代器</td>
</tr>
<tr>
<td>set / multiset</td>
<td>双向迭代器</td>
</tr>
<tr>
<td>map / multimap</td>
<td>双向迭代器</td>
</tr>
<tr>
<td>forward_list</td>
<td>前向迭代器</td>
</tr>
<tr>
<td>unordered_map / unordered_multimap</td>
<td>前向迭代器</td>
</tr>
<tr>
<td>unordered_set / unordered_multiset</td>
<td>前向迭代器</td>
</tr>
<tr>
<td>stack</td>
<td>不支持迭代器</td>
</tr>
<tr>
<td>queue</td>
<td>不支持迭代器</td>
</tr>
</tbody></table>
<h2 id="迭代器的-4-种定义方式"><a href="#迭代器的-4-种定义方式" class="headerlink" title="迭代器的 4 种定义方式"></a>迭代器的 4 种定义方式</h2><table>
<thead>
<tr>
<th>迭代器定义方式</th>
<th>具体格式</th>
</tr>
</thead>
<tbody><tr>
<td>正向迭代器</td>
<td>容器类名::iterator 迭代器名;</td>
</tr>
<tr>
<td>常量正向迭代器</td>
<td>容器类名::const_iterator 迭代器名;</td>
</tr>
<tr>
<td>反向迭代器</td>
<td>容器类名::reverse_iterator 迭代器名;</td>
</tr>
<tr>
<td>常量反向迭代器</td>
<td>容器类名::const_reverse_iterator 迭代器名;</td>
</tr>
</tbody></table>
<ul>
<li><p><code>*迭代器名</code>就表示迭代器指向的元素</p>
</li>
<li><p>常量迭代器和非常量迭代器的分别在于：</p>
<ul>
<li>通过非常量迭代器还能修改其指向的元素</li>
</ul>
</li>
<li><p>反向迭代器和正向迭代器的区别在于：</p>
<ul>
<li>对正向迭代器进行 ++ 操作时，迭代器会指向容器中的后一个元素；</li>
<li>而对反向迭代器进行 ++ 操作时，迭代器会指向容器中的前一个元素</li>
</ul>
</li>
<li><p>以上 4 种定义迭代器的方式，并不是每个容器都适用</p>
</li>
</ul>
<p><img src="http://doc.cloudcollect.cc/upload/2021/04/image-785f568c6578405ebd94206a96cd269e.png" alt="image.png"></p>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//遍历 vector 容器。</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="comment">//需要引入 vector 头文件</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//v被初始化成有10个元素</span></span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; v&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//像普通数组一样使用vector容器</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;第一种遍历方法：&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">        cout &lt;&lt; v[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建一个正向迭代器，当然，vector也支持其他 3 种定义迭代器的方式</span></span><br><span class="line">    cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;第二种遍历方法：&quot;</span> &lt;&lt; endl;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt;::iterator i;</span><br><span class="line">    <span class="comment">//用 != 比较两个迭代器</span></span><br><span class="line">    <span class="keyword">for</span> (i = v.<span class="built_in">begin</span>(); i != v.<span class="built_in">end</span>(); ++i) &#123;</span><br><span class="line">        cout &lt;&lt; *i &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//用 &lt; 比较两个迭代器</span></span><br><span class="line">    cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;第三种遍历方法：&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">for</span> (i = v.<span class="built_in">begin</span>(); i &lt; v.<span class="built_in">end</span>(); ++i) &#123;</span><br><span class="line">        cout &lt;&lt; *i &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;第四种遍历方法：&quot;</span> &lt;&lt; endl;</span><br><span class="line">    i = v.<span class="built_in">begin</span>();</span><br><span class="line">    <span class="keyword">while</span> (i &lt; v.<span class="built_in">end</span>()) &#123;</span><br><span class="line">        <span class="comment">//间隔一个输出</span></span><br><span class="line">        cout &lt;&lt; *i &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        <span class="comment">// 随机访问迭代器支持 &quot;+= 整数&quot;  的操作</span></span><br><span class="line">        i += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        
    </div>
    </div>

    <div class="article-badge">
        
        
    </div>

</div>

<footer class="article-footer">
    <div class="article-more-info">
    <div class="article-date">
  <time datetime="2021-04-24T17:51:31.000Z" itemprop="datePublished">2021-04-25</time>
</div>
    
        <div class="article-category">
        <a class="article-category-link" href="/categories/C/">C++</a>
        </div>
    
    
        <div class="article-tag">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/STL/" rel="tag">STL</a></li></ul>
        </div>
    
    </div>
</footer>

</article>

    
  

  
    <nav class="pagination">
        <a class="extend prev" rel="prev" href="/page/4/">Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/6/">Next</a>
    </nav>
  
</div>

                </section>
            </section>

            
            <aside class="sidebar ">
                


<div class="widget" id="widget">
    
      
    
      
  <div class="widget-wrap widget-tags">
    <div class="widget-title"><span>Tags</span></div>
    <div class="widget-inner">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CentOS/" rel="tag">CentOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Electron/" rel="tag">Electron</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HAProxy/" rel="tag">HAProxy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jenkins/" rel="tag">Jenkins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Maven/" rel="tag">Maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NTP/" rel="tag">NTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/" rel="tag">Oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQLite/" rel="tag">SQLite</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STL/" rel="tag">STL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP-IP/" rel="tag">TCP/IP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Typora/" rel="tag">Typora</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VS2015/" rel="tag">VS2015</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VUE/" rel="tag">VUE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vditor/" rel="tag">Vditor</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openssl/" rel="tag">openssl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" rel="tag">多线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/" rel="tag">开发工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" rel="tag">异常处理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%89%B9%E5%A4%84%E7%90%86/" rel="tag">批处理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" rel="tag">环境搭建</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" rel="tag">计算机组成原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag">计算机网络</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%9F%E6%9F%A5/" rel="tag">速查</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AB%98%E5%8F%AF%E7%94%A8/" rel="tag">高可用</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-cate">
    <div class="widget-title"><span>Categories</span></div>
    <div class="widget-inner">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/C/">C</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/C/">C++</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CentOS/">CentOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Electron/">Electron</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/GIt/">GIt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Maven/">Maven</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nodejs/">Nodejs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Oracle/">Oracle</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringBoot/">SpringBoot</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/VS2015/">VS2015</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/VUE/">VUE</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/">默认分类</a></li></ul>
    </div>
  </div>


    
</div>

<div id="backtop"><i class="icon icon-arrow-up"></i></div>
            </aside>
            
        </div>
    </div>

    <!-- <footer class="footer">
    <div class="footer-wave">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="#3c4859" fill-opacity="1" d="M0,160L60,181.3C120,203,240,245,360,240C480,235,600,181,720,186.7C840,192,960,256,1080,261.3C1200,267,1320,213,1380,186.7L1440,160L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z"></path></svg>
    </div>

    <div class="footer-wrap">
        <div class="footer-inner"> 
            天空 &copy; 2021<br>
            Powered By Hexo · Theme By <a href="https://github.com/lh1me/hexo-theme-aomori" target="_blank">Aomori</a>
        </div>
    </div>

</footer> -->

<!-- 

 -->


<script src="/dist/build.js?1623049492098.js"></script>


<script src="/dist/custom.js?1623049492098.js"></script>









</body>

</html>